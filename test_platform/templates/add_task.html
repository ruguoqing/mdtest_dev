 {% extends 'task_manage.html' %}
 {% block add_task %}


                    <div style="width: 80%;margin-left: 20px;">
                        <form action="/debug/" method="get" class="bs-example bs-example-form"
                              role="form" style="margin-top: 30px">


                            <div class="input-group">
                                <span class="input-group-addon" >名称</span>
                                <input class="form-control" id="req_name" type="text"/>
                            </div>
                            <br>

                            <div class="input-group">
                                <span class="input-group-addon" >描述</span>
                                <textarea  class="form-control" rows='3' id="assert_text" ></textarea>
                            </div>
                            <br>


                            <div class="input-group" id="case_list">
                                <label>用例</label>
                                <br>

                            </div>

                            <div style='width: 100%;heigh: 60px;'>
                                <button class="btn btn-default" type="button" id="back" style="float: right;"
                                        onclick="window.location.href='/interface/task_manage'">返回</button>
                                <button class="btn btn-primary" type="button" id="save" style="float: right;margin-right: 10px">保存</button>

                            </div>
                      </form>
                   </div>


         <script type="text/javascript">

         CaseInit();


          $(document).ready(function() {

                 //验证接口
                 $('#assert').click(function () {
                     let assert_text = $('#assert_text').val()
                     let result_text = $('#result').val()

                     if (assert_text === '' || result_text === '') {
                         window.alert('验证内容或者返回结果不能为空');
                         return;
                     }
                     // 发送一个请求
                     $.post('/interface/api_assert/', {
                         //'djnago接收的': 上面的let变量,
                         'assert_text': assert_text,
                         'result_text': result_text,
                     }, function(resp) {
                         window.alert(resp.msg);
                         return;
                     });
                 });
                 //保存接口
                  $('#save').click(function () {
                     let module = $('#module_name').val()
                     let name = $('#req_name').val()
                     let req_url = $('#req_url').val()
                     let req_method = $('input[name="req_method"]:checked').val()
                     let req_header = $('#req_header').val()
                     let req_ptype = $('input[name="ptype"]:checked').val()
                     let parameter = $('#req_parameter').val()

                     if (req_url === '') {
                         window.alert('URL不能为空');
                         return;
                     }  else if (req_method === '') {
                         window.alert('method不能为空');
                         return;
                     }else if (req_header === '') {
                        req_header = '{}';
                     }else if (parameter === '') {
                         parameter = '{}';
                     }

                     $.post('/interface/save_case/',{
                         //'djnago接收的': 上面的let变量,
                         'module': module,
                         'name': name,
                         'req_url': req_url,
                         'req_method': req_method,
                         'req_header':req_header,
                         'req_ptype': req_ptype,
                         'parameter': parameter
                     },function(resp){
                     window.alert(resp);
                     });

                 });


             })


         </script>

			</div>
		</div>
	</div>

  {% endblock %}